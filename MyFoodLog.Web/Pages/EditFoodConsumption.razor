@page "/editFoodConsumption"
@using MyFoodLog.Web.Components;
@using MyFoodLog.Web.API.Client.Interfaces
@using MyFoodLog.Web.State

@code {

    [CascadingParameter]
    public MainLayoutMaterial? Layout { get; set; }
    
    [Inject]
    protected StateContainer? StateContainer { get; set; }

    private async Task<bool> EditConsumption(IMyFoodLogApi foodLogApi, IMBToastService toastService, AddConsumptionRequestDto addConsumptionRequestDto, CancellationToken ctx)
    {
        try
        {
            if (StateContainer?.SelectedFoodConsumption != null)
            {
                await foodLogApi.FoodConsumption_UpdateAsync(StateContainer.SelectedFoodConsumption.Id, addConsumptionRequestDto.Amount, "1", ctx);

                toastService?.ShowToast(MBToastLevel.Success, $"Successfully updated {addConsumptionRequestDto.Name} to {addConsumptionRequestDto.Amount} {StateContainer?.SelectedFoodItem?.QuantityUnit ?? string.Empty}.", timeout: 1500);

                return true;
            }
        }
        catch (ApiException)
        {
        }

        return false;
    }


    protected override void OnInitialized()
    {
        if (Layout != null)
        {
            Layout.Title = "Edit Consumption";
        }
        
        base.OnInitialized();
    }

}

<div class="mdc-layout-grid__cell--span-3 mdc-layout-grid__cell--span-2-tablet"></div>
<div class="mdc-layout-grid__cell--span-6 mdc-layout-grid__cell--span-4-tablet mdc-layout-grid__cell--span-4-phone">
    <div class="mdc-layout-grid__inner">
        <div class="mdc-layout-grid__cell--span-12-desktop mdc-layout-grid__cell--span-4-tablet mdc-layout-grid__cell--span-4-phone">

            <FoodConsumptionComponent FormHandler="EditConsumption"/>

        </div>

    </div>
</div>
<div class="mdc-layout-grid__cell--span-3 mdc-layout-grid__cell--span-2-tablet"></div>